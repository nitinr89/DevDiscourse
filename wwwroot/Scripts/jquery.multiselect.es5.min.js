"use strict";(function(n){function r(r,u){this.element=r;this.settings=n.extend({},i,u);this._defaults=i;this._name=t;this.init()}var t="multiselect",i={addScrollBar:!0,addSearchBox:!0,addActionBox:!0,animateSearch:!1,searchBoxText:"Type here to search list...",checkAllText:"Check all",uncheckAllText:"Uncheck all",invertSelectText:"Invert select",showCheckboxes:!0,showSelectedItems:!1,overwriteName:!1,submitDataAsArray:!0,preferIdOverName:!0,maxNumOfSelections:-1,onMaxNumExceeded:function(){alert("You cannot select more than "+this.maxNumOfSelections+" items in this list.")},initSelection:n.noop(),cssContainer:"checklistContainer",cssChecklist:"checklist",cssChecklistHighlighted:"checklistHighlighted",cssLeaveRoomForCheckbox:"leaveRoomForCheckbox",cssEven:"even",cssOdd:"odd",cssChecked:"checked",cssDisabled:"disabled",cssShowSelectedItems:"showSelectedItems",cssFocused:"focused",cssFindInList:"findInList",cssBlurred:"blurred",cssContainsPlaceholder:"contains-placeholder",cssOptgroup:"optgroup",listWidth:0,itemWidth:0};n.extend(r.prototype,{init:function(){var i=this,t=this.settings,r=n(this.element),u=t.addScrollBar?"overflow-y: auto; overflow-x: hidden;":"",f=t.showCheckboxes?"padding-left: 25px":"padding-left: 3px";n.each(r,function(){var a=0,f=n(this),u=f.attr("id"),v=f.attr("name"),y,e,c,l,r,p,o,w,tt,s,h;if((u==""||!t.preferIdOverName)&&(u=v.replace(/\[|\]/g,""),u==""))return i.error('Can\'t convert element to checklist.\nYour SELECT element must have a "name" attribute and/or an "id" attribute specified.'),n;if(y=f.outerHeight(),e=t.listWidth?t.listWidth:f.outerWidth(),e-=2,this.type!="select-multiple"&&this.type!="select-one")return i.error('Can\'t convert element to checklist.\nExpecting SELECT element with "multiple" attribute.'),n;if(this.type=="select-one")return n;c=function(){var r=n(this).val(),i,s,f,h,c,o,e;if(r==""&&(r=n(this).html()),r=r.replace(/ /g,"_"),i=u+"_"+r,i=i.replace(/[^A-Z0-9]+/ig,"_"),s=n(this).html(),f="",n(this).attr("disabled"))h=' disabled="disabled"',c=' class="disabled"';else{var h="",c="",f="";n(this).attr("selected")&&(t.maxNumOfSelections!=-1&&a<=t.maxNumOfSelections?(f+='checked="checked"',a++):t.maxNumOfSelections==-1&&(f+='checked="checked"'))}o=t.submitDataAsArray?"[]":"";e=t.preferIdOverName?u+o:v+o;e=e.replace(/\[\]\[\]$/,"[]");n(this).replaceWith('<li tabindex="0"><input type="checkbox" value="'+r+'" name="'+e+'" id="'+i+'" '+f+h+' /><label for="'+i+'"'+c+">"+s+"<\/label><\/li>");t.showCheckboxes===!1?n("#"+i).css("position","absolute").css("left","-50000px"):n("label[for="+i+"]").addClass(t.cssLeaveRoomForCheckbox)};n("optgroup",f).each(function(i){n("option",this).each(c);n(this).replaceWith('<li class="'+t.cssOptgroup+'"><input type="checkbox" class="'+t.cssOptgroup+'" id="'+u+"_"+t.cssOptgroup+"_"+i+'"><label for="'+u+"_"+t.cssOptgroup+"_"+i+'" class="leaveRoomForCheckbox">'+n(this).attr("label")+"<\/label><\/li>"+n(this).html())});n("option",f).each(c);n("li:first",f).each(function(){n(this).hasClass(t.cssOptgroup)&&n(this).css("border-top","none")});l=u+"_checklist";f.replaceWith('<div id="'+u+'" class="'+t.cssContainer+'"><div id="'+l+'"><ul>'+f.html()+"<\/ul><\/div><\/div>");r="#"+l;n("#"+u).attr("showSelectedItems",t.showSelectedItems.toString());n("#"+u).css("width",e+2);n(r).css("position","relative");p=0;t.addSearchBox&&i.addSearchBox(f,r,e,t);t.addActionBox&&i.addActionBox(f,r,e,t);n("li."+t.cssOptgroup,r).on("click","input",function(){var f=parseInt(this.id.replace(u+"_"+t.cssOptgroup+"_","")),e=n("li."+t.cssOptgroup+":eq("+(f+1)+")",r),o=n("li."+t.cssOptgroup+":eq("+f+")",r).nextUntil(e);i.updateChecklist(this.checked?"checkAllGroup":"clearAllGroup",r,o)});o=n("li",r);n(r).addClass(t.cssChecklist);t.addScrollBar?n(r).height(y-p).width(e):n(r).height("100%").width(e);n("ul",r).addClass(t.cssChecklist);n("li:even",r).addClass(t.cssEven);n("li:odd",r).addClass(t.cssOdd);o.focus(function(){n(this).addClass(t.cssFocused)}).blur(function(){n(this).removeClass(t.cssFocused)});t.itemWidth>0&&(w=t.itemWidth+"px",o.each(function(){n(this).css({float:"left",width:w})}));o.each(function(){n("input",this).attr("checked")&&n(this).addClass(t.cssChecked)});var b=function(){o.hasClass(t.cssChecked)?n(r).addClass(t.cssChecklistHighlighted):n(r).removeClass(t.cssChecklistHighlighted)},k=function k(){n(this).prop("tagName").toLowerCase()=="li"&&(n(this).is("li:has(input)")?n(this).focus():n(this).next().each(k))},d=function(i){var f,e;if(i.type!="keydown"||((i.keyCode==32||i.keyCode==13)&&i.preventDefault(),i.keyCode!=9||i.shiftKey?i.keyCode==9&&i.shiftKey:(i.preventDefault(),n(this).off("keydown.tabBack").blur().next().each(k)),i.keyCode==32)){if(f=n("input:checked",r).length,t.maxNumOfSelections!=-1&&f>t.maxNumOfSelections&&!n("input",this).attr("checked")){t.onMaxNumExceeded();i.preventDefault();return}n("label",this).off();i.target.tagName.toLowerCase()!="input"&&i.target.tagName.toLowerCase()!="label"&&n("input",this).trigger("click");e=n("input",this).get(0);g(e);n("#"+u).attr("showSelectedItems")==="true"&&h()}},g=function(i){i.checked?n(i).parent().addClass(t.cssChecked):n(i).parent().removeClass(t.cssChecked);b()},nt=function(){n(this).parent().focus()};n("li:has(input)",r).click(d).keydown(d);n("label",r).focus(nt);n("input",r).focus(nt);b();tt=function(){n("input",this).each(function(){this.checked=this.defaultChecked;g(this);t.showSelectedItems&&h()}).parent()};n("form:has(div."+t.cssChecklist+")").on("reset.fixFormElems",tt);s="#"+u+"_selectedItems";t.showSelectedItems&&n(s).addClass(t.cssShowSelectedItems);h=function(){n(s).html("");n("label",r).each(function(){var r=n(this).parent(),i;n(this).parent().hasClass(t.cssChecked)&&(i=jQuery.trim(n(this).html()),n('<li class="">'+i+"<\/li>").on("click.remove",function(){r.trigger("click")}).appendTo(s))})};t.showSelectedItems&&h()})},updateChecklist:function(t,i,r){var f,e=function(t){t>3&&(f=n(i).attr("showSelectedItems"),n(i).attr("showSelectedItems","false"))},o=function(){n(i).attr("showSelectedItems",f)},r,u;switch(t){case"clearAll":r="li:has(input:checked:not(:hidden))";break;case"checkAll":r="li:has(input:not(:checked,:disabled,:hidden))";break;case"invert":r="li:has(input:not(:hidden))";break;case"checkAllGroup":r=r.find(":input:not(:checked,:disabled,:hidden)");break;case"clearAllGroup":r=r.find(":input:checked:not(:hidden)");break;default:alert("multiselect Plugin says:\n\nWarning - Invalid action requested on checklist.\nThe action requested was: "+t)}u=n(r,i).length;e(u);n(r,i).each(function(t){if(t==u-2&&u>3&&o(),n(this).hasClass("optgroup")){var i=n(this).find(":input");i.prop("checked",!i[0].checked)}else n(this).trigger("click")})},error:function(n){alert("jQuery Plugin Error (Plugin: multiselect)\n\n"+n)},addSearchBox:function(t,i,r,u){var e=function(){n(this).hasClass(u.cssContainsPlaceholder)&&n(this).val("");n(this).removeClass(u.cssBlurred)},f=function(){n("label",i).each(function(){u.animateSearch!==!1?n(this).parent("li").slideDown(u.animateSearch):n(this).parent("li").show()})},o=function(){if(n(this).val()===""){n(this).val(u.searchBoxText);n(this).addClass(u.cssContainsPlaceholder);var t=setTimeout(f,250)}n(this).addClass(u.cssBlurred)},s=function(){n(i).before('<div class="findInList" id="'+t.attr("id")+'_findInListDiv"><input type="text" value="'+u.searchBoxText+'" id="'+t.attr("id")+'_findInList" class="'+u.cssBlurred+" "+u.cssContainsPlaceholder+'" /><\/div>');r-=4;n("#"+t.attr("id")+"_findInList").css("width",r);var s="#"+t.attr("id")+"_findInList";n(s).on("keydown.tabToFocus",function(t){t.keyCode==9&&n("label:first:visible",i).parent().on("keydown.tabBack",function(t){t.keyCode==9&&t.shiftKey&&(t.preventDefault(),n(s).focus(),n(this).off("keydown.tabBack"))}).focus()}).on("focus.focusSearchBox",e).on("blur.blurSearchBox",o).on("keyup",function(){var t=this;if(n(this).val()==="")return f(),!1;n(this).removeClass(u.cssContainsPlaceholder);n("label",i).each(function(){var i=n(this),r,f;i.is(":disabled")||(r=i.text().toLowerCase(),f=t.value.toLowerCase(),r.indexOf(f)==-1?u.animateSearch!==!1?i.parent("li").slideUp(u.animateSearch):i.parent("li").hide():u.animateSearch!==!1?i.parent("li").slideDown(u.animateSearch):i.parent("li").show())});return});findInListDivHeight=n("#"+t.attr("id")+"_findInListDiv").height()+3};s()},addActionBox:function(t,i,r,u){var f=this,e=function(){n(i).after('<div class="actionButtons" id="'+t.attr("id")+'_actionButtons"><span data-action="checkAll" >'+u.checkAllText+'<\/span> | <span data-action="clearAll" >'+u.uncheckAllText+'<\/span> | <span data-action="invert" >'+u.invertSelectText+"<\/span><\/div>");var r="#"+t.attr("id")+"_actionButtons";n(r).on("click","span",function(){var t=n(this).data("action");f.updateChecklist(t,i)})};e()}});n.fn[t]=function(i){return this.each(function(){n.data(this,"plugin_"+t)||n.data(this,"plugin_"+t,new r(this,i))}),this}})(jQuery,window,document);